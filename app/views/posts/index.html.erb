<% if user_signed_in? %>

  <div class="flex flex-wrap px-2 lg:px-24 mt-2 lg:mt-8 container m-auto uppercase text-xs font-semibold">
      Popular discussions
  </div>

    <div class="rounded-tl-lg lg:px-24 rounded-tr-lg container m-auto clearfix">
      <div class="w-full md:w-2/3 pr-0 md:pr-6 mb-6">
        <h5 class="text-xl font-bold float-left">Today</h5>
        <div class="rounded-full float-right">
          <ul id="nav-tab" class="list-none p-0 pt-2 profile-tabs">
            <li class="inline-block mr-2 active" data-tab="profile_submissions">
              <%= link_to "Popular", "#profile_posts", class: "link font-medium text-black hover:text-gray-900 py-3 text-sm" %>
            </li>| 
            <li class="inline-block mr-2" data-tab="profile_comments">
              <%= link_to "Newest", "#profile_comments", class: "link font-medium text-black hover:text-gray-900 py-3 text-sm" %>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <%# @days_from_this_week.each do |day| %>
        <%# day.strftime("%A") %>
    <%# end %>
  
  <% content_for :primary_content do %>
    <% if @posts.exists? %>
      <% render @posts %>
    <% else %>
      <div class="p-10 text-center">
        <%= render_svg "icons/empty", styles: "inline fill-current text-gray-400 mb-2" %>
        <p class="mb-4">Wow such empty...</p>
        <%= link_to 'Creat a Post', new_post_path, class: "btn btn-gray btn-small"%> or 
        <%= link_to 'Join a Room', rooms_path, class: "btn btn-gray btn-small"  %>
      </div>
    <% end %>
  <% end %>

 


  <% content_for :secondary_content do %>
    <div class="px-8 pt-6 pb-8">
      <% unless user_signed_in? %>
        <%= image_tag "illustration.svg", class: "max-w-full" %>
        <h3>Explore</h3>
        <p class="text-gray-600 text-sm">Find your breaking news, sports, TV fan theories, or never-ending streams of cute animals.</p>
        <%= link_to "How Webbit works", "#", class: "btn btn-small btn-white my-2 block text-center" %>
      <% else %>
        <h3>Home</h3>
        <p class="text-gray-600 text-sm">Your personal BLKroom frontpage. Come here to check in with your favorite communities.</p>
        <%= link_to 'Create Post', new_post_path, class: "btn btn-small btn-white my-2 block text-center"  %>
        <%#link_to 'Create Room', new_room_path, class: "btn btn-small btn-gray my-2 block text-center"  %>
        <%= link_to 'Join a Room', rooms_path, class: "btn btn-small btn-gray my-2 block text-center"  %>
      <% end %>
    </div>
  <% end %>


<% else %>

  <%= render "home/header" %>


  <div class="flex flex-wrap px-2 lg:px-24 mt-2 lg:mt-8 container m-auto uppercase text-xs font-semibold">
      Popular discussions
  </div>


  <% if @grouped_posts.present? && @grouped_posts[true].present? %>

    <div class="rounded-tl-lg lg:px-24 rounded-tr-lg container m-auto clearfix">
      <div class="w-full md:w-2/3 pr-0 md:pr-6 mb-6">
        <h5 class="text-xl font-bold float-left">Today</h5>
        <div class="rounded-full float-right">
          <ul id="nav-tab" class="list-none p-0 pt-2 profile-tabs">
            <li class="inline-block mr-2 active" data-tab="profile_submissions">
              <%= link_to "Popular", "#profile_posts", class: "link font-medium text-black hover:text-gray-900 py-3 text-sm" %>
            </li>| 
            <li class="inline-block mr-2" data-tab="profile_comments">
              <%= link_to "Newest", "#profile_comments", class: "link font-medium text-black hover:text-gray-900 py-3 text-sm" %>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
    <div class="flex flex-wrap px-2 lg:px-24 mt-2 lg:mt-3 container m-auto">
      <div class="w-full md:w-2/3 pr-0 md:pr-6 mb-6">
        <div class="bg-white shadow rounded-sm">
          <% @grouped_posts[true].each do |post| %>
            
            <div class="border-b border-r border-l">
              <div class="p-2 pt-2 pb-2 flex items-start flex-wrap hover:bg-gray-100">

                <div id="votes">
                  <%= render "posts/votes", post: post %>
                </div>

                <div class="ml-2">
                  <%= link_to post do %>
                    <%= image_tag post.post_image.large.url, class: "lg:w-24 w-full max-w-full" %>
                  <% end if post.post_image.present? %>

                  <%= link_to post do %>
                    <%= video_tag post.post_video.url, class: "lg:w-24 w-full max-w-full" %>
                  <% end if post.post_video.present? %>
                </div>

                <div class="flex items-start flex-1 pl-4">      
                  <div class="flex-1 w-full">
                    <h3 class="mb-0 flex flex-wrap items-center text-base">
                      <% post_link = post.url.present? ? post.url : post %>
                      <%= link_to post.title, post_link, class: "no-underline font-bold hover:text-gray-600" %>

                      <% if post.url %>
                        <span class="pl-2 text-xs font-normal font-mono text-blue-400 tracking-tight">
                          <%= link_to truncate(post.url, length: 18), post.url, class:"no-underline" %>
                        </span>
                      <% end %>
                    </h3>

                    <%= link_to room_path(post.room), class:"no-underline text-gray-700 font-normal hover:text-gray-700 hover:underline text-sm inline-block" do %>
                        blk/<%= post.room.name %>
                    <% end %>

                    <span class="mx-1 inline-block text-sm text-gray-700">•</span>

                    <%= render 'posts/posted_by', post: post %>
                    <%= render 'posts/actions', post: post %>
                  </div>
                </div>
              </div>
            </div>

          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <% end %>

  <% if @post_wise_sorted_alerts.present? %>

      <% @post_wise_sorted_alerts.reverse_each do |hash_elements|%>
        <div class="rounded-tl-lg lg:px-24 rounded-tr-lg container m-auto clearfix">
          <div class="w-full md:w-2/3 pr-0 md:pr-6 mb-6">
            <h5 class="text-xl font-bold float-left"><%= Date::DAYNAMES[hash_elements.first] %> </h5>
          </div>
        </div>
        
        <div class="flex flex-wrap px-2 lg:px-24 mt-2 lg:mt-3 container m-auto">
          <div class="w-full md:w-2/3 pr-0 md:pr-6 mb-6">
            <div class="bg-white shadow rounded-sm">
              <% hash_elements.last.each do |post| %>
              
                <div class="border-b border-r border-l">
                  <div class="p-2 pt-2 pb-2 flex items-start flex-wrap hover:bg-gray-100">

                    <div id="votes">
                      <%= render "posts/votes", post: post %>
                    </div>

                    <div class="ml-2">
                      <%= link_to post do %>
                        <%= image_tag post.post_image.large.url, class: "lg:w-24 w-full max-w-full" %>
                      <% end if post.post_image.present? %>

                      <%= link_to post do %>
                        <%= video_tag post.post_video.url, class: "lg:w-24 w-full max-w-full" %>
                      <% end if post.post_video.present? %>
                    </div>

                    <div class="flex items-start flex-1 pl-4">      
                      <div class="flex-1 w-full">
                        <h3 class="mb-0 flex flex-wrap items-center text-base">
                          <% post_link = post.url.present? ? post.url : post %>
                          <%= link_to post.title, post_link, class: "no-underline font-bold hover:text-gray-600" %>

                          <% if post.url %>
                            <span class="pl-2 text-xs font-normal font-mono text-blue-400 tracking-tight">
                              <%= link_to truncate(post.url, length: 18), post.url, class:"no-underline" %>
                            </span>
                          <% end %>
                        </h3>

                        <%= link_to room_path(post.room), class:"no-underline text-gray-700 font-normal hover:text-gray-700 hover:underline text-sm inline-block" do %>
                            blk/<%= post.room.name %>
                        <% end %>

                        <span class="mx-1 inline-block text-sm text-gray-700">•</span>

                        <%= render 'posts/posted_by', post: post %>
                        <%= render 'posts/actions', post: post %>
                      </div>
                    </div>
                  </div>
                </div>

              <% end %>
            </div>
          </div>
        </div>
      <% end %>


  <% content_for :secondary_content do %>
    <div class="px-8 pt-6 pb-8">
      <% unless user_signed_in? %>
        <%= image_tag "illustration.svg", class: "max-w-full" %>
        <h3>Explore</h3>
        <p class="text-gray-600 text-sm">Find your breaking news, sports, TV fan theories, or never-ending streams of cute animals.</p>
        <%= link_to "How BLKroom works", about_path, class: "btn btn-small btn-white my-2 block text-center" %>
      <% else %>
        <h3>Home</h3>
        <p class="text-gray-600 text-sm">Your personal BLKroom frontpage. Come here to check in with your favorite communities.</p>
        <%= link_to 'Create Post', new_post_path, class: "btn btn-small btn-white my-2 block text-center"  %>
        <%= link_to 'Create Community', new_room_path, class: "btn btn-small btn-gray my-2 block text-center"  %>
      <% end %>
    </div>
  <% end %>

<% end %>

<%= render "basic_layout" %>


<div class="flex flex-wrap lg:px-24 container m-auto text-center">
  <div class="w-full md:w-2/3 pr-0 md:pr-6 mb-6 inline">
      <%# pagy_nav(@pagy) %>
  </div>
</div>
